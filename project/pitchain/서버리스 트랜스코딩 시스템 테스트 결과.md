í•´ë‹¹ ê¸€ì€ ê¹ƒí—ˆë¸Œ ë¦¬íŒŒì§€í† ë¦¬ì— ì‘ì„±í–ˆë˜ ì´ìŠˆ([#172](https://github.com/Young-Flow/server/issues/172))ë¥¼ ë³µì‚¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.

### ğŸ’¬ Describe

## í…ŒìŠ¤íŠ¸ 
- í…ŒìŠ¤íŠ¸ ë°ì´í„°: 53.9MB í¬ê¸°ì˜ ì˜ìƒ (5ë¶„54ì´ˆ ê¸¸ì´)

![Image](https://github.com/user-attachments/assets/2e02f6d1-0209-4172-a98e-a6f112580c0c)

- ì‹œì‘ ê¸°ê°„ì„ í¬í•¨í•˜ë¯€ë¡œ Cold Startì„ (ì‹œì‘ ê¸°ê°„ì´ í¬í•¨ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ Warm Start)
- ì†Œìš” ì‹œê°„: 289595ms (ì•½ 5ë¶„)
- ì„¤ì •í•œ Lambda Memory: 3008MB (ì„¤ì •í•  ìˆ˜ ìˆëŠ” ìµœëŒ€í¬ê¸°, docsì—ëŠ” 10,240MB ê¹Œì§€ ê°€ëŠ¥í•˜ë‹¤ê³  í•˜ëŠ”ë° ì˜¤ë¥˜ê°€ ëœ¨ë”ë¼ê³ ìš”. ì§ì ‘ AWSì— ë¬¸ì˜í•´ì„œ í¬ê¸°ë¥¼ ëŠ˜ë ¤ì•¼ í•œëŒ€ìš”.)
  - ë©”ëª¨ë¦¬ 1,769MB ë‹¹ vCPU 1ê°œ (ì¦‰, í˜„ì¬ vCPU 2ê°œ)
  - í”„ë¦¬í‹°ì–´ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ vCPUê°€ 2ê°œì¸ ê±¸ ìƒê°í•˜ë©´ ë§ì”€í•˜ì‹  ëŒ€ë¡œ EC2ë¡œ ë°”ê¿”ë„ ì„±ëŠ¥ ì°¨ì´ëŠ” í¬ê²Œ ì—†ì„ ê²ƒì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ë¬¼ë¡  Cold Startê°€ ì¹˜ëª…ì ì¸ ë¬¸ì œë¼ë©´ EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë„ìš°ëŠ” ê²ƒì´ ë§ê² ì§€ë§Œ ì•„ë˜ë¥¼ ë³´ì‹œë©´.. 

## ì›ì¸ ë¶„ì„
### 1. Cold Startì˜ ì˜í–¥ì€ ë¯¸ë¹„í•¨
- Cold Start (Init Duration í¬í•¨) 
```REPORT RequestId: 104c1c0c-85dd-43a8-9c9e-e2ecbd6ec391	Duration: 293261.07 ms	Billed Duration: 293262 ms	Memory Size: 3008 MB	Max Memory Used: 673 MB	Init Duration: 396.72 ms```

- Warm Start (Init Duration ì—†ìŒ) 
```REPORT RequestId: bbef22e3-03bf-498a-bdc5-64de85b58ae1	Duration: 293371.88 ms	Billed Duration: 293372 ms	Memory Size: 3008 MB	Max Memory Used: 678 MB```
- Billed Durationì„ ë³´ë©´ ë¹„ìŠ·í•œ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¬ì§€ì–´ ì´ë ‡ê²Œ Warm Startê°€ ë” ê¸¸ê²Œ ë‚˜ì˜¤ê¸°ë„ í•˜ë”ë¼ê³ ìš”. ì• ì´ˆì— staticìœ¼ë¡œ ì„ ì–¸í•œ ë©”ì„œë“œë‚˜ ë³€ìˆ˜ê°€ ì—†ì–´ì„œ ê·¸ëŸ°ì§€ ë‘ ê²½ìš° ì°¨ì´ê°€ ì–¼ë§ˆ ì—†ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. 
- ê·¸ë¦¬ê³  ì•„ë˜ ë³´ì‹œë©´ Cold StartëŠ” 100ms~1s ì •ë„ ê±¸ë¦¬ëŠ”ë° (ë¬¼ë¡  í˜„ì—…ì—ì„œëŠ” ë” ê¸¸ê²Œ ë³´ê³  ìˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤) ì‘ê³  ë¹ ë¥¸ ê¸°ëŠ¥ì—ì„œëŠ” ìœ ì˜ë¯¸í•œ ìˆ˜ì¹˜ê² ì§€ë§Œ, ì €í¬ê°€ ì œê³µí•˜ëŠ” ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ê³  ì‚¬ìš©ìì—ê²Œ ì•ŒëŒìœ¼ë¡œ ì™„ë£Œë¥¼ ì•Œë ¤ì£¼ëŠ” ì—…ë¡œë“œ ê¸°ëŠ¥ì—ì„œ ì´ê±¸ ì‹ ê²½ì“°ëŠ” ê±´ í¬ê²Œ ì˜ë¯¸ê°€ ì—†ëŠ” ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤.
> Cold starts typically occur in under 1% of invocations. The duration of a cold start varies from under 100 ms to over 1 second.

### 2. FFmpegì˜ ë†’ì€ CPU ì‚¬ìš©ëŸ‰
- ê²°ë¡ ì ìœ¼ë¡œ ê·¸ëƒ¥ FFmpegì´ ëŠë¦° ê²ƒ...
- ì•„ë˜ ì‚¬ì§„ì„ ë³´ì‹œë©´ íŠ¸ëœìŠ¤ì½”ë”©í•˜ëŠ”ë° 5ë¶„ ì •ë„ ì†Œìš”ë©ë‹ˆë‹¤.
  
![Image](https://github.com/user-attachments/assets/9c66c13e-2844-4e1a-98a2-6eabe8b6f486)

- FFmpeg ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ëŠ”ë° ì‹œê°„ì´ ë§ì´ ì†Œìš”ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŒ
  - ë¡œì»¬ì—ì„œ ê°™ì€ ë°ì´í„°ë¥¼ ëŒë ¤ë´¤ì„ ë•Œ 2ë¶„ 30ì´ˆ ì†Œìš”
    
![Image](https://github.com/user-attachments/assets/8c2a14ae-2422-4111-9af0-7902a9e121e2)

  - ë¡œì»¬ ì»´í“¨í„° CPU Core 4ê°œ ê¸°ì¤€ CPU ì‚¬ìš©ëŸ‰ 90%ì— ìœ¡ë°•
  - ì°¾ì•„ë³´ë‹ˆê¹Œ íŠ¸ëœìŠ¤ì½”ë”© ìì²´ê°€ ì›ë˜ CPUë¥¼ ë§ì´ ë¨¹ëŠ” ì‘ì—…ì´ë¼ê³  í•˜ë”ë¼ê³ ìš”. ê¸°ë³¸ì ìœ¼ë¡œ ëŠë¦¬ë‹¤ë³´ë‹ˆ GPU ë“±ì„ ì‚¬ìš©í•´ì„œ ì„±ëŠ¥ì„ ê°œì„ í•˜ëŠ” ë°©ë²•ë„ ìˆì—ˆìŠµë‹ˆë‹¤. 


### ğŸ“Œ Tasks

1. FFmpeg ëª…ë ¹ì–´ ì»¤ìŠ¤í„°ë§ˆì´ì§•
   - FFmpeg ì„±ëŠ¥ì„ í–¥ìƒí•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ì˜µì…˜ì´ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤. 
   - [Using FFmpeg as a HLS streaming server (Part 8) â€“ Reducing delay](https://www.martin-riedl.de/2020/04/17/using-ffmpeg-as-a-hls-streaming-server-part-8-reducing-delay/) ì´ ê¸€ì—ì„œëŠ” ì„¸ê·¸ë¨¼íŠ¸ì˜ ê¸¸ì´ë¥¼ ì¤„ì´ëŠ” ë°©ë²•ì„ ì¶”ì²œí•˜ê³  ìˆìŠµë‹ˆë‹¤. 

2. AWS Lambda ì–¸ì–´ Pythonìœ¼ë¡œ ë³€ê²½
>  For simple functions, interpreted languages like Python and Node.js offer the fastest performance. For functions with more complex computation, compiled languages like Java are often slower to initialize but run quickly in the Lambda handler. Choice of runtime is also influenced by developer preference and language familiarity.
   - ìƒì‚°ì„± ì¸¡ë©´ì—ì„œ Python, Node.js (ìš”ì¦˜ì€ Rust, Go) ì–¸ì–´ë¥¼ ë§ì´ ì¶”ì²œí•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì´ê²Œ Cold Start ë¬¸ì œë¥¼ í•´ê²°í•´ì£¼ëŠ” ì¸¡ë©´ì—ì„œ ì¶”ì²œí•˜ëŠ” ê²ƒ ê°™ì€ë°, ì–¸ì–´ë¥¼ ë°”ê¾¼ë‹¤ê³  í•´ì„œ ì–¼ë§ˆë‚˜ ì„±ëŠ¥ì´ í–¥ìƒë ì§€ëŠ” ì˜ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤. 

3. íŠ¸ëœìŠ¤ì½”ë”© ì„œë²„ë¥¼ ë”°ë¡œ êµ¬ì¶•
ë¹„ìš©ì ì¸ ì¸¡ë©´ì€ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´ì•¼ ì •í™•íˆ ì•Œ ìˆ˜ ìˆê² ì§€ë§Œ, í™•ì‹¤íˆ CPU ì‚¬ìš©ëŸ‰ì´ ë§ì€ ì‘ì—…ì— ëŒ€í•´ì„œëŠ” Lambdaë³´ë‹¤ EC2ê°€ í›¨ì”¬ ì €ë ´í•˜ë”ë¼ê³ ìš”. íŠ¸ëœìŠ¤ì½”ë”©ì€ CPU ì‚¬ìš©ëŸ‰ì´ ë§ìœ¼ë¯€ë¡œ ì¥ê¸°ì ìœ¼ë¡œ ë´¤ì„ ë•Œ EC2ê°€ ë” ì €ë ´í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.
DB ê°’ ë³€ê²½(ì˜ìƒ ìƒíƒœ ê°’), ì˜ˆì™¸ ì²˜ë¦¬ ë“± ë¶€ê°€ì ì¸ ì‘ì—…ë“¤ì„ ì²˜ë¦¬í•´ì•¼ í•œë‹¤ë©´ í˜¸ì¶œí•´ì•¼ í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë‚˜ ì½”ë“œì˜ ì–‘ë„ ëŠ˜ì–´ë‚˜ê¸° ë•Œë¬¸ì— Cold Startë¡œ ì¸í•œ ì§€ì—° ì‹œê°„ì´ ëŠ˜ì–´ë‚  ê²ƒì´ë¼ê³  ì˜ˆìƒí•©ë‹ˆë‹¤. (ë¬¼ë¡  ì €í¬ëŠ” Cold Start ë¬¸ì œë¥¼ ì•„ì§ ê³ ë ¤í•˜ì§€ ì•Šê¸°ë¡œ í–ˆì§€ë§Œ..)
ê²°ë¡ ì ìœ¼ë¡œ Lambdaê°€ ìˆ˜í–‰í•˜ëŠ” ì‘ì—… ìì²´ê°€ ë§ì•„ì§€ê³  ê±°ëŒ€í•´ì§€ëŠ” ê²ƒ ìì²´ë¥¼ í™•ì‹¤íˆ ê²½ê³„í•´ì•¼ í•  í•„ìš”ì„±ì´ ìˆë”ë¼ê³ ìš”. LambdaëŠ” ê°€ë³ê³  ë¹ ë¥¸ ê¸°ëŠ¥ì´ë‚˜ ê°„í—ì ìœ¼ë¡œ í˜¸ì¶œë ë§Œí•œ ê¸°ëŠ¥ì— ì í•©í•œ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

### ETC

- [Optimizing AWS Lambda function performance for Java](https://aws.amazon.com/ko/blogs/compute/optimizing-aws-lambda-function-performance-for-java/)
- [Measuring cold start time of AWS Lambda functions with Java and SnapStart](https://filia-aleks.medium.com/measuring-cold-start-time-of-aws-lambda-functions-with-java-and-snapstart-5c0fd994614)
- [Understanding the Lambda execution environment lifecycle](https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtime-environment.html#runtimes-lifecycle-ib)
